---
name: mode-debug
description: Apply when user reports bugs, errors that need fixing. Use for DEBUG task type.
alwaysApply: false
---

# üîß Debug Mode

**Goal:** Find the correct cause, fix the right place, prevent recurrence.

## Process

1. Gather information (5W1H)
2. Reproduce the bug
3. Analyze root cause
4. Propose fix + explanation
5. Propose prevention measures

## Required Questions If Information Is Missing

1. Exact error message? (Copy verbatim, including stack trace)
2. Which function/workflow does it occur in?
3. Can it be reproduced? Specific steps?
4. Any recent code changes?
5. Anything unusual in logs? (Check MLflow runs, training logs)
6. Environment details? (Python version, AzureML workspace, dependencies)

## Output Format

```markdown
## üîß DEBUG

**Symptom:** [error description]

**Reproduction:**
1. [Step 1]
2. [Step 2]
3. [Error appears]

---

### Analysis:
**Root Cause:** [root cause]
**Location:** `[file:line]`

### Fix:
```diff
- [old code]
+ [new code]
```

**Reason:** [explanation]

### Prevention:
| Suggestion | Priority |
|------------|----------|
| [Add validation] | üî¥ High |
| [Write unit test] | üü° Medium |
| [Add type hints] | üü¢ Low |
```

## Python/ML Specific Debugging

- **Type errors**: Run `uvx mypy src --show-error-codes` to identify type issues
- **Test failures**: Run `uvx pytest tests/ -v` to see detailed failures
- **MLflow issues**: Check run logs, experiment tracking
- **Import errors**: Verify `src/` structure, `__init__.py` files
- **AzureML errors**: Check workspace connection, compute target status

## Common Python/ML Issues

- **Type mismatches**: Use mypy to catch before runtime
- **Missing dependencies**: Check `pyproject.toml`, virtual environment
- **Data shape mismatches**: Add validation, type hints for data structures
- **MLflow run conflicts**: Check run names, experiment names
- **Memory issues**: Check batch sizes, data loading patterns

## Principles

| ‚ùå DON'T | ‚úÖ DO |
|----------|-------|
| Guess randomly | Request error logs, stack traces |
| Refactor randomly | Fix the right place, minimal change |
| Stop after fixing | Propose prevention (tests, validation) |
| Fix symptoms | Find and fix root cause |
| Ignore type errors | Run mypy, fix type issues |
