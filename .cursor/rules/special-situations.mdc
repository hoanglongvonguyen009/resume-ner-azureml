---
name: special-situations
description: How to handle special situations during development.
alwaysApply: true
---

# Special Situations

How to handle special situations.

## 1. Discovering Serious Issues

```markdown
‚ö†Ô∏è **Warning:** Potential issue detected:

**Issue:** [description]
**Location:** `[file:line]`
**Severity:** [Critical / High / Medium / Low]
**Recommendation:** [action]

Handle this issue first or continue with the original request?
```

**Examples:**
- Security vulnerability (hardcoded secrets, SQL injection risk)
- Data loss risk (unsafe file operations, missing backups)
- Performance issue in production path (memory leak, inefficient algorithm)
- Type safety violation (`Any` usage, missing type hints)

## 2. Request Exceeds Capabilities

```markdown
üîÑ This request exceeds support scope because:
- [Reason]

**Alternative suggestions:**
1. [Solution 1]
2. [Solution 2]
```

**Examples:**
- Requires external API access not available
- Needs domain expertise outside ML/Python
- Requires infrastructure changes beyond code

## 3. Need More Context

```markdown
üìã Need more information:
1. [Question]?
2. [Question]?

Or proceed with assumptions:
- [Assumption]
```

**Common scenarios:**
- Missing configuration values
- Unclear business requirements
- Ambiguous error messages
- Multiple possible interpretations

## 4. Breaking Changes

```markdown
‚ö†Ô∏è **BREAKING CHANGE**

Affects:
- [ ] API contracts (function signatures, return types)
- [ ] Database schema (if applicable)
- [ ] Configuration files
- [ ] MLflow experiment structure
- [ ] Training workflow interfaces

**Files:** [list]

**Migration steps:**
1. [Step]
2. [Step]

**Confirm to proceed?**
```

**Python/ML specific breaking changes:**
- Function signature changes (parameters, return types)
- Class interface changes (methods removed/renamed)
- MLflow run structure changes (metric names, tag keys)
- Training workflow API changes
- Configuration schema changes

## 5. DRY Violations Detected

When discovering duplicate code:

```markdown
üìã **DRY Violation Detected**

**Duplication found:**
- `file1.py:lines` and `file2.py:lines` contain similar logic

**Recommendation:**
- Extract to shared utility in `src/common/` or appropriate module
- Follow reuse-first principles

**Options:**
1. Consolidate now (if small change)
2. Note for follow-up refactoring
3. Continue with current task and suggest separate refactor

Which approach do you prefer?
```

## FAQ

**Q: When to ask the user?**
- Missing important information (config values, requirements)
- Multiple interpretations possible
- Breaking changes involved
- Trade-offs needed (performance vs. simplicity)
- DRY violations detected (consolidate now or later?)

**Q: Suggest improvements outside scope?**
Only **SUGGEST** when:
- Serious issue detected (security, data loss, performance)
- Small change, big improvement (extract duplicate, fix type hint)
- Directly related to task (refactor opportunity while fixing bug)

**Q: Encountering bad legacy code?**
1. Complete the task first
2. Note the issues (in comments or implementation plan)
3. Suggest separate refactor (create implementation plan if significant)
4. DO NOT refactor unilaterally (follow scope-bound principle)

**Q: Finding duplicate code patterns?**
- Small duplication (< 10 lines): Extract immediately if straightforward
- Larger duplication: Note it, suggest consolidation in separate task
- Follow reuse-first principles: Check for existing utilities before creating new ones
